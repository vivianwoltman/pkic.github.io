<!doctype html><html><head><title>Intermediate CA Certificates and Their Potential For Misuse For Man-In-The-Middle Attacks | Public Key Infrastructure (PKI) Consortium</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Intermediate CA Certificates and Their Potential For Misuse For Man-In-The-Middle Attacks"><meta property="og:description" content="We have seen recently that Google detected that publicly trusted TLS/(SSL) certificates had been created for Google domains without having been requested by Google themselves.
The existence of such certificates might usually be taken as an indication of misissuance by the issuing CA (i.e. a failure or mistake by the CA which allowed the issuance of an end-entity certificate otherwise than in accordance with their policy) or as an indication of compromise of the issuing CA."><meta property="og:type" content="article"><meta property="og:url" content="https://pkic.org/2014/01/09/intermediate-ca-certificates-and-their-potential-for-misuse-for-man-in-the-middle-attacks/"><meta property="article:published_time" content="2014-01-09T21:00:38+00:00"><meta property="article:modified_time" content="2014-01-09T21:00:38+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Intermediate CA Certificates and Their Potential For Misuse For Man-In-The-Middle Attacks"><meta name=twitter:description content="We have seen recently that Google detected that publicly trusted TLS/(SSL) certificates had been created for Google domains without having been requested by Google themselves.
The existence of such certificates might usually be taken as an indication of misissuance by the issuing CA (i.e. a failure or mistake by the CA which allowed the issuance of an end-entity certificate otherwise than in accordance with their policy) or as an indication of compromise of the issuing CA."><link rel=canonical href=https://pkic.org/2014/01/09/intermediate-ca-certificates-and-their-potential-for-misuse-for-man-in-the-middle-attacks/><meta name=theme-color content="#142547"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1 crossorigin=anonymous><style>@import "http://fonts.googleapis.com/css?family=Roboto:400,300,700";html,body{display:flex;flex-direction:column;min-height:100vh;font-family:roboto,sans-serif!important}main{flex:1}#content{text-align:justify}#sidebar{color:rgba(107,107,107,.849)}#sidebar a{color:currentColor}#participate{color:#fff;text-align:center;font-size:1.6em;font-weight:200!important}#participate a{color:currentColor}.member-logo{height:40px;max-width:175px;filter:invert(.5)}.member-logo:hover{filter:none}.linkArea{color:currentColor;text-decoration:none}.badge{text-decoration:none}.bd-placeholder-img{font-size:1.125rem;text-anchor:middle;-webkit-user-select:none;-moz-user-select:none;user-select:none}figure{margin:2rem;text-align:center}figure>img{max-width:80%}figcaption{font-size:70%;text-align:center}blockquote{font-size:1.3em;margin-left:-1.2em;font-weight:400!important;font-style:italic;color:#555;padding:1.2em 30px 1.2em 75px;border-left:8px solid #212529;line-height:1.6;position:relative;background:#efefef}blockquote::before{font-family:Arial;content:"\201C";color:#212529;font-size:4em;position:absolute;left:10px;top:-10px}blockquote::after{content:''}blockquote h4{display:block;color:#333;font-style:normal;font-weight:700;margin-top:1em}.highlight>pre{padding:1.5rem}table,td,th{padding:.5em;margin:1em;border:1px solid #212529}main h2{text-align:left;font-size:1.6em;padding-top:1em;font-weight:500!important}main h3{text-align:left;font-size:1.2em;padding-top:1em;font-weight:500!important}main h4{text-align:left;font-size:1.1em;padding-top:1em;font-weight:500!important}@media(min-width:768px){.bd-placeholder-img-lg{font-size:3.5rem}}</style></head><body><div class="collapse bg-dark" id=navbarHeader><div class=container><div class=row><div class="col-sm-8 col-md-7 py-4"><h4 class=text-white>About</h4><p class=text-muted>Add some information about the album below, the author, or any other background context. Make it a few sentences long so folks can pick up some informative tidbits. Then, link them off to some social networking sites or contact information.</p></div><div class="col-sm-4 offset-md-1 py-4"><h4 class=text-white>Contact</h4><ul class=list-unstyled><li><a href=# class=text-white>Follow on Twitter</a></li><li><a href=# class=text-white>Like on Facebook</a></li><li><a href=# class=text-white>Email me</a></li></ul></div></div></div></div><div class="sticky-top navbar navbar-expand-lg navbar-dark bg-dark shadow-sm"><div class=container><a href=/ class="navbar-brand d-flex align-items-center"><img src=/img/logo.png height=30 alt=Logo></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarContent><div class="navbar-nav me-auto"></div><div class="navbar-nav mb-2 mb-lg-0"><a class=nav-link title="PKI Consortium" href=/>Home</a>
<a class=nav-link title=Blog href=/blog/>Blog</a>
<a class=nav-link title="About us" href=/about/>About us</a>
<a class=nav-link title=Members href=/members/>Members</a></div></div></div></div><main><div class="py-3 bg-light"></div><section class="text-center container"><div class="row pt-5"><div class="col-10 mx-auto"><h1 class=fw-light>Intermediate CA Certificates and Their Potential For Misuse For Man-In-The-Middle Attacks</h1><p class="lead text-muted"><h4>Thursday January 9, 2014</h4></p></div></div></section></div><div class=py-5><div class=container><div class=row><div class="col-md-9 order-md-1"><article id=content><p>We have seen recently that Google detected that publicly trusted TLS/(SSL) certificates had been created for Google domains without having been requested by Google themselves.</p><p>The existence of such certificates might usually be taken as an indication of misissuance by the issuing CA (i.e. a failure or mistake by the CA which allowed the issuance of an end-entity certificate otherwise than in accordance with their policy) or as an indication of compromise of the issuing CA.</p><p>In this case the problem was not quite either of those things but instead arose from the issuance of an unconstrained trusted intermediate CA certificate by one part of the French government to another part. Following on from that was the (probably inadvertent) misuse of that CA certificate to issue a further intermediate CA certificate which was used in a security appliance of some sort to terminate TLS connections within an enterprise probably for DLP (Data Loss Prevention).</p><p>It seems counter-intuitive that such things should even be possible and unthinkable that relying parties (i.e. everyone) could be put at risk by the existence of such intermediate CA certificates, so let’s take a moment to examine how and why these things exist and what safeguards are in place.</p><ol><li>What legitimate use could there be for an appliance that sits between end users and the websites or other internet resources they access and whose aim is to terminate the TLS connection for the purpose of reading the (otherwise encrypted) traffic between the user and the website?</li></ol><pre><code>In the general case where the end user is on the public internet then there is no legitimate use for such an appliance &amp;ndash; and of course the successful deployment of such an appliance would require the compromise of various other elements of internet infrastructure such as internet traffic routing, domain name resolution (or both) in addition to the availability of either an unconstrained trusted intermediate CA certificate or trusted and unrevoked end entity certificates (and their respective private keys) for each site or resource with whom otherwise secured traffic was to be intercepted.

Nonetheless there is a legitimate market for such appliances when used in a closed (typically enterprise) environment. One example might be when providing an internet connection to a financial dealing-room where there is a regulatory requirement that the dealers should have all of their communications recorded and where the dealers using the network are aware of the recording and understand that they can have no expectation of privacy when using the dealing-room network. Even here it is important that any measures taken by the appliance present no risk at all to everyone outside the dealing-room, and in this case this should be achieved by having the appliance use certificates which are issued not from a publicly trusted CA but instead from a private CA which is trusted only within the environment of the dealing-room. This is achievable with a small level of effort for most closed or enterprise deployments to make the private CA &amp;lsquo;trusted&amp;rsquo; within their own defined scope.
</code></pre><ol start=2><li>Is there anything that prevents every would-be attacker from getting an unconstrained trusted intermediate CA certificate which they could use with one of these appliances?</li></ol><pre><code>Yes!

Publicly trusted root CAs may not issue an unconstrained intermediate CA certificate to be used in a security appliance because to do so violates the CA/B Forum&amp;rsquo;s baseline requirements (section 11.1.1) on the means of ensuring that a TLS/SSL certificate is never issued without confirmation from someone who owns or controls the domain name.

There are other reasons that a root CA may consider issuing an unconstrained intermediate CA certificate to a third party but whatever the reason such a CA certificate may not be issued unless that third party is subjected to the same level of audit as would qualify the third party to be a root CA in their own right (section 17) and the root CA remains responsible (section 18.3) for the intermediate CA&amp;rsquo;s actions including their compliance with the baseline requirements.

In addition to these prohibitions in the CA/B Forum&amp;rsquo;s baseline requirements which are included by reference into most major browsers&amp;rsquo; root program&amp;rsquo;s policy, Mozilla (the producer of the FireFox browser) asked all root CAs in their program to add a statement to the CA&amp;rsquo;s CP/CPS committing that they will not issue a subordinate (aka intermediate) certificate that can be used for MITM or &amp;ldquo;traffic management&amp;rdquo; of domain names or IPs that the certificate holder does not legitimately own or control.

The publicly trusted root CAs are all being audited to demonstrate their compliance with the CA/B Forum&amp;rsquo;s baseline requirements.
</code></pre><p>None of the members of the CA Security Council issue unconstrained intermediate CAs from trusted roots to enterprises (or anyone else!) for this purpose, and all CA Security Council members have been in compliance with the root program requirements since they were introduced.</p><h3 id=references>References <a class=header-link href=#references><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-link-45deg" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 104.243 4.243l1.828-1.829A3 3 0 008.586 5.5L8 6.086a1.001 1.001.0 00-.154.199 2 2 0 01.861 3.337L6.88 11.45A2 2 0 114.05 8.62l.793-.792a4.018 4.018.0 01-.128-1.287z"/><path d="M6.586 4.672A3 3 0 007.414 9.5l.775-.776a2 2 0 01-.896-3.346L9.12 3.55a2 2 0 012.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 00-4.243-4.243L6.586 4.672z"/></svg></a></h3><p><a href=https://community.qualys.com/blogs/laws-of-vulnerabilities/2013/12/09/internal-mitm-attack-in-french-government-agency>https://community.qualys.com/blogs/laws-of-vulnerabilities/2013/12/09/internal-mitm-attack-in-french-government-agency</a></p><p><a href=http://googleonlinesecurity.blogspot.co.uk/2013/12/further-improving-digital-certificate.html>http://googleonlinesecurity.blogspot.co.uk/2013/12/further-improving-digital-certificate.html</a></p><p><a href=http://en.wikipedia.org/wiki/Man-in-the-middle_attack>http://en.wikipedia.org/wiki/Man-in-the-middle_attack</a></p><p><a href=https://wiki.mozilla.org/CA:Communications#February_17.2C_2012>https://wiki.mozilla.org/CA:Communications#February_17.2C_2012</a></p></article></div><div class="col-md-3 order-md-2 px-md-5"><p>Reading time: <strong>4 minutes</strong></p><h4>Authors</h4><p><a href=/members/sectigo/#robin-alden title="Chief Compliance Officer at Sectigo">Robin Alden</a>
(<a href=https://www.sectigo.com/ title="Sectigo partners with organizations of all sizes to deliver automated public and private PKI solutions for securing web servers, user access, connected devices, and applications. Recognized for its award-winning innovation and best-in-class global customer support, Sectigo has the proven performance needed to secure the digital landscape of today and tomorrow." target=_blank>Sectigo</a>)</p><h4>Related Articles</h4><ul><li><a href=/2014/12/16/poodle-for-tls/>POODLE for TLS</a></li><li><a href=/2014/11/30/tis-the-season-for-online-safety/>’Tis the Season for Online Safety</a></li><li><a href=/2014/11/21/a-follow-up-on-poodle-and-ssl-3.0/>A Follow-up on POODLE and SSL 3.0</a></li><li><a href=/2014/11/18/the-cost-of-creating-collisions-using-sha-1/>The Cost of Creating Collisions Using SHA-1</a></li><li><a href=/2014/10/30/extra-trips-are-for-frequent-flyers-not-ssl/tls-performance/>Extra Trips are for Frequent Flyers, Not SSL/TLS Performance</a></li></ul></div></div></div></div><div class="py-5 bg-light"><div class=container><div class=text-center><a class="btn btn-primary my-2" title="Previous article" href=https://pkic.org/2014/01/06/2014-looking-back-moving-forward/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>2014 – Looking Back, Moving Forward</a>
<a class="btn btn-primary my-2" title="Next article" href=https://pkic.org/2014/01/16/always-on-ssl-part-i/>Always-On SSL, Part I<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></a></div></div></div></main><div class=container><div class="row py-5 justify-content-center text-center"><div class="col py-4 px-5"><a href=/members/dtrust/ title="D-Trust, Paving the way for social and economic progress - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="D-Trust, Paving the way for social and economic progress - A member of the Public Key Infrastructure (PKI) Consortium" title="D-Trust, Paving the way for social and economic progress - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/dtrust/dtrust.svg></a></div><div class="col py-4 px-5"><a href=/members/entrust/ title="Entrust, Securing a world in motion - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="Entrust, Securing a world in motion - A member of the Public Key Infrastructure (PKI) Consortium" title="Entrust, Securing a world in motion - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/entrust/entrust.svg></a></div><div class="col py-4 px-5"><a href=/members/harica/ title="Harica, Hellenic Academic and Research Institutions Certification Authority - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="Harica, Hellenic Academic and Research Institutions Certification Authority - A member of the Public Key Infrastructure (PKI) Consortium" title="Harica, Hellenic Academic and Research Institutions Certification Authority - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/harica/harica.svg></a></div><div class="col py-4 px-5"><a href=/members/sectigo/ title="Sectigo, Over 20 Years of Established Leadership - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="Sectigo, Over 20 Years of Established Leadership - A member of the Public Key Infrastructure (PKI) Consortium" title="Sectigo, Over 20 Years of Established Leadership - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/sectigo/sectigo.svg></a></div><div class="col py-4 px-5"><a href=/members/securetrust/ title="Secure Trust, A TrustWave Company - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="Secure Trust, A TrustWave Company - A member of the Public Key Infrastructure (PKI) Consortium" title="Secure Trust, A TrustWave Company - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/securetrust/securetrust.png></a></div><div class="col py-4 px-5"><a href=/members/ssldotcom/ title="SSL.com, Trust is what we do - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="SSL.com, Trust is what we do - A member of the Public Key Infrastructure (PKI) Consortium" title="SSL.com, Trust is what we do - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/ssldotcom/ssldotcom.svg></a></div></div></div><div id=participate class="py-3 bg-success"><div class=container>Participate in our <a href=https://github.com/pkic/community/discussions target=_blank>community</a> discussions and/or <a href=/join/>join</a> the consortium</div></div><footer class=bg-dark><div class=container><a href=https://github.com/pkic/pkic.github.io/edit/main/content/blog/2014/2014-01-09-intermediate-ca-certificates.md class="btn btn-sm btn-outline-light align-top float-end m-3">Improve this page</a><div class="text-muted py-5"><a href=https://twitter.com/PKIConsortium target=_blank class="linkArea px-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-twitter" viewBox="0 0 16 16"><path d="M5.026 15c6.038.0 9.341-5.003 9.341-9.334.0-.14.0-.282-.006-.422A6.685 6.685.0 0016 3.542a6.658 6.658.0 01-1.889.518 3.301 3.301.0 001.447-1.817 6.533 6.533.0 01-2.087.793A3.286 3.286.0 007.875 6.03a9.325 9.325.0 01-6.767-3.429 3.289 3.289.0 001.018 4.382A3.323 3.323.0 01.64 6.575v.045a3.288 3.288.0 002.632 3.218 3.203 3.203.0 01-.865.115 3.23 3.23.0 01-.614-.057 3.283 3.283.0 003.067 2.277A6.588 6.588.0 01.78 13.58 6.32 6.32.0 010 13.535 9.344 9.344.0 005.026 15z"/></svg></a><a href=https://www.linkedin.com/groups/4852478/ target=_blank class="linkArea px-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4z"/></svg></a><a href=https://github.com/pkic target=_blank class="linkArea px-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-github" viewBox="0 0 16 16"><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a></div><div class="text-muted py-2"><p class=float-end><a href=# title="Back to top" class=m-3><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#fff" class="bi bi-chevron-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M7.646 4.646a.5.5.0 01.708.0l6 6a.5.5.0 01-.708.708L8 5.707l-5.646 5.647a.5.5.0 01-.708-.708l6-6z"/></svg></a></p><p>© 2021 PKI Consortium, Inc. All Rights Reserved</p></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js integrity=sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW crossorigin=anonymous></script></body></html>