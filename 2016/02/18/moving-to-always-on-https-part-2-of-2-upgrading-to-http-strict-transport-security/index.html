<!doctype html><html><head><title>Moving to Always on HTTPS, Part 2 of 2; Upgrading to HTTP Strict Transport Security | Public Key Infrastructure (PKI) Consortium</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Moving to Always on HTTPS, Part 2 of 2; Upgrading to HTTP Strict Transport Security"><meta property="og:description" content="Part 1 of this blog post discussed browser security indicators and how to avoid getting warnings about mixed content on your website. (Mixed content leaves a door open that allows an attacker to snoop or inject malicious content during the browsing session.) This Part 2 discusses other technical measures to implement Always on HTTPS. As I noted previously, one of the difficulties with implementing Always on HTTPS is that content is often provided by third parties."><meta property="og:type" content="article"><meta property="og:url" content="https://pkic.org/2016/02/18/moving-to-always-on-https-part-2-of-2-upgrading-to-http-strict-transport-security/"><meta property="article:published_time" content="2016-02-18T16:15:16+00:00"><meta property="article:modified_time" content="2016-02-18T16:15:16+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Moving to Always on HTTPS, Part 2 of 2; Upgrading to HTTP Strict Transport Security"><meta name=twitter:description content="Part 1 of this blog post discussed browser security indicators and how to avoid getting warnings about mixed content on your website. (Mixed content leaves a door open that allows an attacker to snoop or inject malicious content during the browsing session.) This Part 2 discusses other technical measures to implement Always on HTTPS. As I noted previously, one of the difficulties with implementing Always on HTTPS is that content is often provided by third parties."><link rel=canonical href=https://pkic.org/2016/02/18/moving-to-always-on-https-part-2-of-2-upgrading-to-http-strict-transport-security/><link rel=icon href=/favicon.svg><meta name=theme-color content="#212528"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1 crossorigin=anonymous><style>@import "https://fonts.googleapis.com/css?family=Roboto:400,300,700";:root{--color: rgb(25, 135, 84);--pagination-color: $color !important}html,body{display:flex;flex-direction:column;min-height:100vh;font-family:roboto,sans-serif!important}a{color:var(--color)}a:hover{color:var(--color);filter:opacity(60%)}.badge:hover{color:#fff!important;background-color:var(--color)!important;filter:none}main{flex:1}#content{text-align:justify}#sidebar{color:rgba(107,107,107,.849)}#sidebar a{color:currentColor}#participate{color:#fff;text-align:center;font-size:1.6em;font-weight:200!important}#participate a{color:currentColor}.member-logo{height:40px;max-width:175px;filter:invert(.5)}#members a:hover,.member-logo:hover{filter:none}.linkArea{color:currentColor;text-decoration:none}.badge{text-decoration:none}.bd-placeholder-img{font-size:1.125rem;text-anchor:middle;-webkit-user-select:none;-moz-user-select:none;user-select:none}figure{margin:2rem;text-align:center}figure>img{max-width:80%}figcaption,figcaption h4{font-size:70%;text-align:center!important}blockquote{font-size:1.3em;margin-left:-1.2em;font-weight:400!important;font-style:italic;color:#555;padding:1.2em 30px 1.2em 75px;border-left:8px solid #212529;line-height:1.6;position:relative;background:#efefef}blockquote::before{font-family:Arial;content:"\201C";color:#212529;font-size:4em;position:absolute;left:10px;top:-10px}blockquote::after{content:''}blockquote h4{display:block;color:#333;font-style:normal;font-weight:700;margin-top:1em}.highlight>pre{padding:1.5rem}table,td,th{padding:.5em;margin:1em;border:1px solid #212529}main h2{text-align:left;font-size:1.6em;padding-top:1em;font-weight:500!important}main h3{text-align:left;font-size:1.2em;padding-top:1em;font-weight:500!important}main h4{text-align:left;font-size:1.1em;padding-top:1em;font-weight:500!important}@media(min-width:768px){.bd-placeholder-img-lg{font-size:3.5rem}}</style></head><body><div class="sticky-top navbar navbar-expand-lg navbar-dark bg-dark shadow-sm"><div class=container><a href=/ class="navbar-brand d-flex align-items-center"><img src=/img/logo.svg height=30 alt=Logo></a>
<button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navbarContent><div class="navbar-nav me-auto"></div><div class="navbar-nav mb-2 mb-lg-0"><a class=nav-link title="PKI Consortium" href=/>Home</a>
<a class=nav-link title=Blog href=/blog/>Blog</a>
<a class=nav-link title="About us" href=/about/>About us</a>
<a class=nav-link title=Members href=/members/>Members</a></div></div></div></div><main><div class="py-2 bg-light"></div><section class="text-center container"><div class="row pt-5"><div class="col-10 mx-auto"><h1 class=fw-light>Moving to Always on HTTPS, Part 2 of 2; Upgrading to HTTP Strict Transport Security</h1><p class="lead text-muted">Thursday February 18, 2016</p></div></div></section><div class=py-5><div class=container><div class=row><div class="col-md-9 order-md-1"><article id=content><p>Part 1 of this blog post discussed browser security indicators and how to avoid getting warnings about mixed content on your website.  (Mixed content leaves a door open that allows an attacker to snoop or inject malicious content during the browsing session.)  This Part 2 discusses other technical measures to implement Always on HTTPS.  As I noted previously, one of the difficulties with implementing Always on HTTPS is that content is often provided by third parties.  I suggested that you require HTTPS from them as well. However, until you are able to get them to do this you will need to find another way to serve up content via HTTPS.  One approach is to collect the material locally and serve it up from the same origin – your HTTPS server.</p><p>A key concept is the security model governing the way that browsers retrieve and use content.  This is known as the Same-Origin Policy.  It dictates that browsers trust content provided by the same HTTPS site, but treat content from different origins without that trust. “Roughly speaking, two URIs are part of the same origin (i.e., represent the same principal) if they have the same scheme, host, and port.”  Section 3.2 (Origin) in “RFC 6454:  The Web Origin Concept”,  <a href=https://tools.ietf.org/html/rfc6454>https://tools.ietf.org/html/rfc6454</a>.   Cross-origin privileges created by mixed content are controlled in order to protect against security vulnerabilities.  So, make everything HTTPS by making it originate from your own secure servers.</p><p>Once you have configured your web properties with Always on HTTPS, then you can implement HTTP Strict Transport Security (HSTS).  HSTS is a directive included in the header field that forces web browsers to communicate with your site by only using HTTPS.  As outlined in RFC 6797, HSTS provides a mechanism to “force HTTPS.”  By including an HSTS directive in the page header, a web browser is directed to not allow users to click through HTTPS security warnings.  HSTS differs from the Same-Origin Policy (SOP) in that it is an affirmative directive from the website to the browser and that it applies to the connection between the browser and website regardless of the port number (HSTS can be applied on an “entire-host” basis), whereas the Same-Origin Policy is origin-based and limited in scope.    HSTS will protect visitors from downgrade attacks such as SSL Strip. See <a href=http://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf>http://www.blackhat.com/presentations/bh-dc-09/Marlinspike/BlackHat-DC-09-Marlinspike-Defeating-SSL.pdf</a></p><h2 id=upcoming-developments>Upcoming Developments <a class=header-link href=#upcoming-developments><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-link-45deg" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 104.243 4.243l1.828-1.829A3 3 0 008.586 5.5L8 6.086a1.001 1.001.0 00-.154.199 2 2 0 01.861 3.337L6.88 11.45A2 2 0 114.05 8.62l.793-.792a4.018 4.018.0 01-.128-1.287z"/><path d="M6.586 4.672A3 3 0 007.414 9.5l.775-.776a2 2 0 01-.896-3.346L9.12 3.55a2 2 0 012.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 00-4.243-4.243L6.586 4.672z"/></svg></a></h2><p>One upcoming development is a W3C proposal to upgrade insecure requests with a new Content Security Policy directive.  <a href=https://www.w3.org/TR/upgrade-insecure-requests/>https://www.w3.org/TR/upgrade-insecure-requests/</a>.   “Most notably, mixed content checking has the potential to cause real headache for administrators tasked with moving substantial amounts of legacy content onto HTTPS. In particular, going through old content and rewriting resource URLs manually is a huge undertaking. Moreover, it’s often the case that truly legacy content is difficult or impossible to update. Consider the BBC’s archived websites, or the New York Times’ hard-coded URLs.  We should remove this burden from site authors by allowing them to assert to a user agent that they intend a site to load only secure resources, and that insecure URLs ought to be treated as though they had been replaced with equivalent secure URLs.”</p><p>A recommendation in the W3C proposal involves processing HSTS before evaluating the page for mixed content.  (“If the origin is HSTS-safe, then protect against SSL-stripping man-in-the-middle attacks by sending a Strict-Transport-Security header with the preload directive, and ensure that insecure content is never loaded by enabling Mixed Content’s strict mode.”)  Browsers should prime and preload HSTS before checking for mixed content using the Same-Origin Policy, but that isn’t how it currently happens – “HSTS is currently checked after mixed content blocking has already happened. This is due to the fundamental property that HSTS takes effect only after a user’s agent has requested a resource from a host that sends the header.” <a href=https://mikewest.github.io/hsts-priming/>https://mikewest.github.io/hsts-priming/</a>   Priming HSTS means that the browser checks whether there is an HTTPS version of the content, and whether the origin has an HSTS record cached in the browser.  A priming request attempts to validate whether an insecure reference has an HSTS policy before blocking it as mixed content, thereby allowing an upgrade from HTTP to HTTPS.</p><h2 id=conclusion>Conclusion <a class=header-link href=#conclusion><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-link-45deg" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 104.243 4.243l1.828-1.829A3 3 0 008.586 5.5L8 6.086a1.001 1.001.0 00-.154.199 2 2 0 01.861 3.337L6.88 11.45A2 2 0 114.05 8.62l.793-.792a4.018 4.018.0 01-.128-1.287z"/><path d="M6.586 4.672A3 3 0 007.414 9.5l.775-.776a2 2 0 01-.896-3.346L9.12 3.55a2 2 0 012.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 00-4.243-4.243L6.586 4.672z"/></svg></a></h2><p>In this blog post I have discussed the Same-Origin Policy, mixed content, and the security indicators given by browsers when secure HTTPS content is tainted with unsecure HTTP content.  I’ve also provided some tips to help you navigate an error-free presentation of your web content.  Most notably is the HSTS header.  (See <a href=https://casecurity.org/2014/10/08/secure-your-website-with-hsts/>https://casecurity.org/2014/10/08/secure-your-website-with-hsts/</a> for our HSTS configuration instructions.)  Finally, I introduced you to a new W3C development that will leverage your investment in HSTS even more.</p></article></div><div class="col-md-3 order-md-2 px-md-5"><p>Reading time: <strong>4 minutes</strong></p><h4>Authors</h4><p>Ben Wilson</p><h4>Related Articles</h4><ul><li><a href=/2016/12/13/stricter-standards-for-ssl-server-test-coming-in-2017/>Stricter Standards for SSL Server Test Coming in 2017</a></li><li><a href=/2016/12/08/leading-certificate-authorities-and-microsoft-introduce-new-standards-to-protect-consumers-online/>Leading Certificate Authorities and Microsoft Introduce New Standards to Protect Consumers Online</a></li><li><a href=/2016/11/21/the-web-is-moving-from-http-to-https/>The Web Is Moving From HTTP to HTTPS</a></li><li><a href=/2016/11/11/trust-on-the-public-web-the-consequences-of-covert-action/>Trust on the Public Web – The Consequences of Covert Action</a></li><li><a href=/2016/11/08/google-certificate-transparency-ct-to-expand-to-all-certificates-types/>Google Certificate Transparency (CT) to Expand to All Certificates Types</a></li></ul></div></div></div></div><div class="py-5 bg-light"><div class=container><div class=text-center><a class="btn btn-primary my-2" title="Previous article" href=https://pkic.org/2016/02/03/moving-to-always-on-https-part-1-of-2-marking-http-as-unsecure/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-left" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M11.354 1.646a.5.5.0 010 .708L5.707 8l5.647 5.646a.5.5.0 01-.708.708l-6-6a.5.5.0 010-.708l6-6a.5.5.0 01.708.0z"/></svg>Moving to Always on HTTPS, Part 1 of 2; Marking HTTP as Unsecure</a>
<a class="btn btn-primary my-2" title="Next article" href=https://pkic.org/2016/03/30/stay-safe-this-tax-season-by-looking-for-ssl/tls-certificates/>Stay Safe This Tax Season by Looking for SSL/TLS Certificates<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-chevron-right" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4.646 1.646a.5.5.0 01.708.0l6 6a.5.5.0 010 .708l-6 6a.5.5.0 01-.708-.708L10.293 8 4.646 2.354a.5.5.0 010-.708z"/></svg></a></div></div></div></main><div id=members class=container><div class="row py-5 justify-content-center text-center"><div class="col py-4 px-5"><a href=/members/sectigo/ title="Sectigo, Over 20 Years of Established Leadership - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="Sectigo, Over 20 Years of Established Leadership - A member of the Public Key Infrastructure (PKI) Consortium" title="Sectigo, Over 20 Years of Established Leadership - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/sectigo/sectigo.svg></a></div><div class="col py-4 px-5"><a href=/members/dtrust/ title="D-Trust, Paving the way for social and economic progress - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="D-Trust, Paving the way for social and economic progress - A member of the Public Key Infrastructure (PKI) Consortium" title="D-Trust, Paving the way for social and economic progress - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/dtrust/dtrust.svg></a></div><div class="col py-4 px-5"><a href=/members/entrust/ title="Entrust, Securing a world in motion - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="Entrust, Securing a world in motion - A member of the Public Key Infrastructure (PKI) Consortium" title="Entrust, Securing a world in motion - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/entrust/entrust.svg></a></div><div class="col py-4 px-5"><a href=/members/harica/ title="HARICA, Hellenic Academic and Research Institutions Certification Authority - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="HARICA, Hellenic Academic and Research Institutions Certification Authority - A member of the Public Key Infrastructure (PKI) Consortium" title="HARICA, Hellenic Academic and Research Institutions Certification Authority - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/harica/harica.svg></a></div><div class="col py-4 px-5"><a href=/members/sslcom/ title="SSL.com, Trust is what we do - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="SSL.com, Trust is what we do - A member of the Public Key Infrastructure (PKI) Consortium" title="SSL.com, Trust is what we do - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/sslcom/sslcom.svg></a></div><div class="col py-4 px-5"><a href=/members/securetrust/ title="Secure Trust, A TrustWave Company - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="Secure Trust, A TrustWave Company - A member of the Public Key Infrastructure (PKI) Consortium" title="Secure Trust, A TrustWave Company - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/securetrust/securetrust.png></a></div><div class="col py-4 px-5"><a href=/members/buypass/ title="Buypass, We bring you a safer digital world - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="Buypass, We bring you a safer digital world - A member of the Public Key Infrastructure (PKI) Consortium" title="Buypass, We bring you a safer digital world - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/buypass/buypass.svg></a></div><div class="col py-4 px-5"><a href=/members/firmaprofesional/ title="Firmaprofesional, We innovate to create secure and efficient transaction environments - A member of the Public Key Infrastructure (PKI) Consortium"><img class="mx-auto member-logo" alt="Firmaprofesional, We innovate to create secure and efficient transaction environments - A member of the Public Key Infrastructure (PKI) Consortium" title="Firmaprofesional, We innovate to create secure and efficient transaction environments - A member of the Public Key Infrastructure (PKI) Consortium" src=https://pkic.org/images/members/firmaprofesional/firmaprofesional.svg></a></div></div></div><div id=participate class="py-3 bg-success"><div class=container>Participate in our <a href=https://github.com/pkic/community/discussions target=_blank>community</a> discussions and/or <a href=/join/>join</a> the consortium</div></div><footer class=bg-dark><div class=container><a href=https://github.com/pkic/pkic.github.io/edit/main/content/blog/2016/2016-02-18-moving-to-always-on-https-part-2-of-2-upgrading-to-http-strict-transport-security.md class="btn btn-sm btn-outline-light align-top float-end m-3">Improve this page</a><div class="text-muted py-5"><a href=https://twitter.com/PKIConsortium target=_blank class="linkArea px-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-twitter" viewBox="0 0 16 16"><path d="M5.026 15c6.038.0 9.341-5.003 9.341-9.334.0-.14.0-.282-.006-.422A6.685 6.685.0 0016 3.542a6.658 6.658.0 01-1.889.518 3.301 3.301.0 001.447-1.817 6.533 6.533.0 01-2.087.793A3.286 3.286.0 007.875 6.03a9.325 9.325.0 01-6.767-3.429 3.289 3.289.0 001.018 4.382A3.323 3.323.0 01.64 6.575v.045a3.288 3.288.0 002.632 3.218 3.203 3.203.0 01-.865.115 3.23 3.23.0 01-.614-.057 3.283 3.283.0 003.067 2.277A6.588 6.588.0 01.78 13.58 6.32 6.32.0 010 13.535 9.344 9.344.0 005.026 15z"/></svg></a><a href=https://www.linkedin.com/groups/4852478/ target=_blank class="linkArea px-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-linkedin" viewBox="0 0 16 16"><path d="M0 1.146C0 .513.526.0 1.175.0h13.65C15.474.0 16 .513 16 1.146v13.708c0 .633-.526 1.146-1.175 1.146H1.175C.526 16 0 15.487.0 14.854V1.146zm4.943 12.248V6.169H2.542v7.225h2.401zm-1.2-8.212c.837.0 1.358-.554 1.358-1.248-.015-.709-.52-1.248-1.342-1.248-.822.0-1.359.54-1.359 1.248.0.694.521 1.248 1.327 1.248h.016zm4.908 8.212V9.359c0-.216.016-.432.08-.586.173-.431.568-.878 1.232-.878.869.0 1.216.662 1.216 1.634v3.865h2.401V9.25c0-2.22-1.184-3.252-2.764-3.252-1.274.0-1.845.7-2.165 1.193v.025h-.016a5.54 5.54.0 01.016-.025V6.169h-2.4c.03.678.0 7.225.0 7.225h2.4z"/></svg></a><a href=https://github.com/pkic target=_blank class="linkArea px-1"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentcolor" class="bi bi-github" viewBox="0 0 16 16"><path d="M8 0C3.58.0.0 3.58.0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38.0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95.0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12.0.0.67-.21 2.2.82.64-.18 1.32-.27 2-.27s1.36.09 2 .27c1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15.0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48.0 1.07-.01 1.93-.01 2.2.0.21.15.46.55.38A8.012 8.012.0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a></div><div class="text-muted py-2"><p class=float-end><a href=# title="Back to top" class=m-3><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="#fff" class="bi bi-chevron-up" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M7.646 4.646a.5.5.0 01.708.0l6 6a.5.5.0 01-.708.708L8 5.707l-5.646 5.647a.5.5.0 01-.708-.708l6-6z"/></svg></a></p><p>© 2021 PKI Consortium, Inc. All Rights Reserved</p></div></div></footer><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js integrity=sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW crossorigin=anonymous></script></body></html>